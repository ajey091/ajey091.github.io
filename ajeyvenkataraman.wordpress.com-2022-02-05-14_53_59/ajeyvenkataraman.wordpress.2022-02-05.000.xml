<?xml version="1.0" encoding="UTF-8"?>
<!--
 This is a WordPress eXtended RSS file generated by WordPress as an export of your site.
 It contains information about your site's posts, pages, comments, categories, and other content.
 You may use this file to transfer that content from one site to another.
 This file is not intended to serve as a complete backup of your site.

 To import this information into a WordPress site follow these steps:
 1. Log in to that site as an administrator.
 2. Go to Tools: Import in the WordPress admin panel.
 3. Install the "WordPress" importer from the list.
 4. Activate & Run Importer.
 5. Upload this file using the form provided on that page.
 6. You will first be asked to map the authors in this export file to users
    on the site. For each author, you may choose to map to an
    existing user on the site or to create a new user.
 7. WordPress will then import each of the posts, pages, comments, categories, etc.
    contained in this file into your site.
-->
<!-- generator="WordPress.com" created="2022-02-05 14:54"-->
<rss version="2.0" xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:wp="http://wordpress.org/export/1.2/">
  <channel>
<title>Ajey Venkataraman</title>
<link>http://ajeyvenkataraman.com</link>
<description>Welcome to Ajey's personal page!</description>
<pubDate>Sat, 05 Feb 2022 14:54:01 +0000</pubDate>
<language>en</language>
<wp:wxr_version>1.2</wp:wxr_version>
<wp:base_site_url>http://wordpress.com/</wp:base_site_url>
<wp:base_blog_url>http://ajeyvenkataraman.com</wp:base_blog_url>
<wp:author>
  <wp:author_id>33711037</wp:author_id>
  <wp:author_login>baroquemusings</wp:author_login>
  <wp:author_email>ajey.091@gmail.com</wp:author_email>
  <wp:author_display_name><![CDATA[Ajey]]></wp:author_display_name>
  <wp:author_first_name><![CDATA[Ajey]]></wp:author_first_name>
  <wp:author_last_name><![CDATA[Venkataraman]]></wp:author_last_name>
</wp:author>
<wp:term>
  <wp:term_id>1357</wp:term_id>
  <wp:term_taxonomy>nav_menu</wp:term_taxonomy>
  <wp:term_slug>primary</wp:term_slug>
  <wp:term_name><![CDATA[Primary]]></wp:term_name>
</wp:term>
<wp:term>
  <wp:term_id>695328713</wp:term_id>
  <wp:term_taxonomy>nav_menu</wp:term_taxonomy>
  <wp:term_slug>social-media</wp:term_slug>
  <wp:term_name><![CDATA[Social media]]></wp:term_name>
</wp:term>
<generator>http://wordpress.com/</generator>

<image>
	<url>https://ajeyvenkataraman.files.wordpress.com/2022/01/cropped-img_1876.jpeg?w=32</url>
	<title>Ajey Venkataraman</title>
	<link>http://ajeyvenkataraman.com</link>
	<width>32</width>
	<height>32</height>
</image> 
<item>
  <title>I built a web app to generate artist/names using Deep Learning</title>
  <link>http://ajeyvenkataraman.com/2022/02/01/generating-artist-names-using-deep-learning/</link>
  <pubDate>Tue, 01 Feb 2022 16:01:47 +0000</pubDate>
  <dc:creator>baroquemusings</dc:creator>
  <guid isPermaLink="false">https://ajeyvenkataraman.com/?p=729</guid>
  <description/>
  <content:encoded><![CDATA[<!-- wp:paragraph -->
<p>At the height of a snowy Chicago winter and in the midst of another wave of the pandemic, a recent hobby I have picked up has been mixing songs using a DJ controller. It has been a deeply engaging activity and I have been uploading mixes to <a href="https://soundcloud.com/ajey-venkataraman">my soundcloud</a> (unabashed self-promotion). However, one challenge I have faced is to come up with an artist/DJ name - there are too many factors to consider and most obviously good ideas are already taken. So I tried to delegate the task to a deep learning algorithm. While generative models are exciting, they typically require large amounts of data to train, and they are time and resource intensive; they are still in their nascent stages at this point. </p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="the-idea">The Idea</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The basic idea is to train a deep learning model to&nbsp;learn the structure in a provided corpus of words. We will invoke already trained Long Short Term Memory networks (<a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">LSTMs</a>), a special kind of recurrent neural networks that are capable of learning long-term dependencies.&nbsp;LSTMs typically work very well for understanding the structure behind language (words and sentences) and are hence commonly used in machine translation and speech recognition. The following is an itemized list of the steps we will follow: </p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li>We will find sources of data on the internet about previous artist names </li><li>Train the LSTM model to learn the structure and patterns behind these artist names</li><li>Ask the trained model to generate new names </li><li>Use <code>Flask</code> to serve the model  </li><li>Host the model on a heroku web server</li></ol>
<!-- /wp:list -->

<!-- wp:heading -->
<h2 id="data-collection-and-cleanup">Data collection and cleanup</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I used two different data sources as input to the LSTM model, which I combined to train the model - the first dataset is from the <a href="https://musicbrainz.org/">MusicBrainz</a>&nbsp;database which consists of over&nbsp;1.4 Million&nbsp;musical artists. The second dataset is from scraping the Wikipedia page for the<a href="https://en.wikipedia.org/wiki/List_of_club_DJs"> list of club DJ names</a> using <a href="https://beautiful-soup-4.readthedocs.io/en/latest/">BeautifulSoup</a>. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>[gist https://gist.github.com/ajey091/20d27a66db56f58979c2d8785772a062]</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We also clean up the data we obtain from the MusicBrainz website - specifically, we will only choose names from english-speaking countries and keep only alphabets. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>[gist https://gist.github.com/ajey091/8d7a62f59256fd9b678c5cafcec0a397]</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We then append the two sources of data and feed into the model. </p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="model">Model</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>There are already excellent trained LSTM models for text generation on the internet - there is no point in reinventing the wheel. We will invoke the <a href="https://github.com/AlexEngelhardt/startup-name-generator">startup-name-generator (sng)</a> model. We will train this model on the dataset that we generated in the previous step. The training takes a few tens of minutes; the time taken for generation of words is proportional to the number of words we request - on my local machine, the trained model took about 3 seconds for every 10 words. This might be a problem when we deploy it to the web server, we will address this issue in the next section. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>[gist https://gist.github.com/ajey091/6f2d1d203d99ab9dc9d6f259bb9509d7]</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="serving-with-flask">Serving with Flask</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We will use the pickled model to make generations for a number requested by the user and host it on a local server. We will create a file <code>app.py</code>:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>[gist https://gist.github.com/ajey091/84b7695c33a59fbd2bac1414e18f0026]</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We will use a simple, standard html template for our endpoint. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>[gist https://gist.github.com/ajey091/cb5794a1458ef48dbf1694ec92acb71d]</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When we run <code>app.py</code>, we will be able to see our artist name generation file at <code>http://127.0.0.1:5000/</code>. </p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="web-hosting-with-heroku">Web hosting with Heroku</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Heroku is a web hosting platform that easily integrates with Flask. The basic idea is to host whatever we have running on our local server to a URL on the web. Firstly, we need to create a virtual environment and install dependencies:</p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>python3 -m venv venv
source venv/bin/activate
(venv) &gt; pip install flask gunicorn sng 
(venv) &gt; pip freeze &gt; requirements.txt
(venv) &gt; less requirements.txt
click==8.0.3
Flask==2.0.2
gunicorn==20.1.0
itsdangerous==2.0.1
Jinja2==3.0.3
MarkupSafe==2.0.1
numpy==1.22.1
pandas==1.4.0
python-dateutil==2.8.2
pytz==2021.3
six==1.16.0
sng==0.3.2
Werkzeug==2.0.2
</code></pre>
<!-- /wp:code -->

<!-- wp:paragraph -->
<p>Next, we get into hosting on Heroku. This process is fairly, simple although getting it to actually work the first time is sometimes challenging. First we need to create a <code>Procfile</code> inside the main folder with just one line: </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>web: gunicorn app:flask_app</code> </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Then we create a free account on <a href="https://dashboard.heroku.com/">Heroku</a>. </p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>(venv) &gt; git init
(venv) &gt; heroku login
(venv) &gt; git add .
(venv) &gt; git commit -m "first commit"
(venv) &gt; git push heroku main</code></pre>
<!-- /wp:code -->

<!-- wp:paragraph -->
<p>The <code>heroku login</code> command takes you to the login page, where we have to enter our credentials. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The final command above takes a while to finish, since we are uploading not only our files but also installing the dependencies on the remote server. Once we're done with that step, we should see our application hosted on the web server. My website is hosted at:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://generate-djnames.herokuapp.com/">https://generate-djnames.herokuapp.com/</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Note that you will be initially assigned a random URL, which you can easily change in the Heroku dashboard. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>An important consideration is that running our app on a web server takes significantly more time than running on our local machine because of all the overhead. When I was testing this app, my generation step would constantly time out. The way I overcame this issue was by requesting a large number (100K) of generations during the training phase and caching the results in a text file. Then, on our web server, we can just randomly sample from the text file, which is much faster. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Here is a snippet of the output: </p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":749,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://ajeyvenkataraman.files.wordpress.com/2022/02/image.png?w=862" alt="" class="wp-image-749" /></figure>
<!-- /wp:image -->]]></content:encoded>
  <excerpt:encoded><![CDATA[]]></excerpt:encoded>
  <wp:post_id>729</wp:post_id>
  <wp:post_date>2022-02-01 10:01:47</wp:post_date>
  <wp:post_date_gmt>2022-02-01 16:01:47</wp:post_date_gmt>
  <wp:post_modified>2022-02-01 21:51:38</wp:post_modified>
  <wp:post_modified_gmt>2022-02-02 03:51:38</wp:post_modified_gmt>
  <wp:comment_status>open</wp:comment_status>
  <wp:ping_status>open</wp:ping_status>
  <wp:post_name>generating-artist-names-using-deep-learning</wp:post_name>
  <wp:status>publish</wp:status>
  <wp:post_parent>0</wp:post_parent>
  <wp:menu_order>0</wp:menu_order>
  <wp:post_type>post</wp:post_type>
  <wp:post_password/>
  <wp:is_sticky>0</wp:is_sticky>
  <category domain="post_tag" nicename="deep-learning"><![CDATA[Deep Learning]]></category>
  <category domain="post_tag" nicename="flask"><![CDATA[flask]]></category>
  <category domain="post_tag" nicename="heroku"><![CDATA[heroku]]></category>
  <category domain="post_tag" nicename="lstm"><![CDATA[lstm]]></category>
  <category domain="category" nicename="machine-learning"><![CDATA[Machine Learning]]></category>
  <category domain="category" nicename="python3"><![CDATA[Python3]]></category>
  <category domain="category" nicename="text-analysis"><![CDATA[Text Analysis]]></category>
  <category domain="post_tag" nicename="text-generation"><![CDATA[text generation]]></category>
  <wp:postmeta>
    <wp:meta_key>_last_editor_used_jetpack</wp:meta_key>
    <wp:meta_value><![CDATA[block-editor]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta>
    <wp:meta_key>_oembed_a7e3f2459ac20a0f54535cd8ac0ed4f0</wp:meta_key>
    <wp:meta_value><![CDATA[{{unknown}}]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta>
    <wp:meta_key>_publicize_job_id</wp:meta_key>
    <wp:meta_value><![CDATA[68437862252]]></wp:meta_value>
  </wp:postmeta>
  <wp:postmeta>
    <wp:meta_key>timeline_notification</wp:meta_key>
    <wp:meta_value><![CDATA[1643731309]]></wp:meta_value>
  </wp:postmeta>
</item>
  </channel>
</rss>
